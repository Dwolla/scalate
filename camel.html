<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd"> 
<html lang="en">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="scala template engine implementing HAML, JSP, Erb style templates" name="description"/>
    <meta content="scalate,scala,template engine,haml,erb,jsp" name="keywords"/>
    <meta content="Scalate" name="author"/>
    <script src="scripts/jquery.js"></script>
    <script type='text/javascript'>
      //<![CDATA[
        $(function() {
          $("#navigation div.edit img").click(function() {
            $("#files_popup").toggle("slow");
            return false;
          });
        });    
      //]]>
    </script>
    <link type="text/css" rel="stylesheet" href="styles/impact/css/pygmentize.css"/>
    <link type="text/css" rel="stylesheet" href="styles/impact/css/site.css"/>
    <title>Scalate Camel Component</title>
  </head>
  <body>
    <div id="navigation">
      <div class="edit">
        <img src="images/edit.png"/>
      </div>
      <div class="wrapper">
<ul>
<li><a href="index.html">Scalate</a></li>
<li><a href="download.html">Download</a></li>
<li><a href="source.html">Source</a></li>
<li><a href="community.html">Community</a></li>
<li><a href="support.html">Support</a></li>
<li><a href="documentation/index.html">Documentation</a></li>
</ul>      </div>
    </div>
    <div id="files_popup" class="popover top">
      <div class="inner">
        <h3 class="title">Fork this page on GitHub</h3>
        <div class="content">
          <ul>
            <li>
              <a href="https://github.com/scalate/scalate/edit/master/scalate-website/src/camel.page">camel.page</a>
            </li>
            <li>
              <a href="https://github.com/scalate/scalate/edit/master/scalate-website/src/_navigation.ssp.md">_navigation.ssp.md</a>
            </li>
            <li>
              <a href="https://github.com/scalate/scalate/edit/master/scalate-website/src/WEB-INF/scalate/layouts/default.jade">WEB-INF/scalate/layouts/default.jade</a>
              <div></div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div id="overview">
      <div class="wrapper">
        <div class="logo">
          <img src="images/project-logo.png" alt="Scalate logo"/>
        </div>
        <div class="message">
<h1 id = "Scalate_Camel_Component">Scalate Camel Component</h1>
          <div></div>
        </div>
      </div>
    </div>
    <div id="content">
      <div class="wrapper">
<h2 id="ScalateCamelComponent">Scalate Camel Component</h2><p>The <strong>scalate:</strong> <a href="http://camel.apache.org/">camel</a> component allows you to process a message using <a href="http://scalate.github.io/scalate/">Scalate</a> template, which supports various template languages such as</p><ul><li><p><a href="http://scalate.github.io/scalate/documentation/ssp-reference.html">SSP</a> for text generation using a JSP / Velocity like syntax</p></li><li><p><a href="http://scalate.github.io/scalate/documentation/jade.html">Jade</a> for generating HTML markup using a really DRY and concise template engine</p></li></ul><p>This can be ideal when using <a href="http://camel.apache.org/templating.html">Templating</a> to generate responses for requests.</p><p>Maven users will need to add the following dependency to their <tt>pom.xml</tt> for this component, and use the correct version of Scalate:</p><div class="syntax"><div class="highlight"><pre><span class="nt">&lt;dependency&gt;</span>&#x000A;    <span class="nt">&lt;groupId&gt;</span>org.fusesource.scalate<span class="nt">&lt;/groupId&gt;</span>&#x000A;    <span class="nt">&lt;artifactId&gt;</span>scalate-camel_${scala_compat_tag}<span class="nt">&lt;/artifactId&gt;</span>&#x000A;    <span class="nt">&lt;version&gt;</span>${scalate.version}<span class="nt">&lt;/version&gt;</span>&#x000A;<span class="nt">&lt;/dependency&gt;</span>&#x000A;</pre></div>&#x000A;</div><h3 id="URIformat">URI format</h3><div class="syntax"><div class="highlight"><pre>scalate:templateName[?options]&#x000A;</pre></div>&#x000A;</div><p>Where <strong>templateName</strong> is the classpath-local URI of the template to invoke; or the complete URL of the remote template (eg: file://folder/myfile.ssp).</p><p>You can append query options to the URI in the following format, <tt>?option=value&amp;option=value&amp;...</tt></p><h3 id="MessageHeaders">Message Headers</h3><p>The scalate component sets a couple headers on the message (you can't set these yourself and from Camel 2.1 scalate component will not set these headers which will cause some side effect on the dynamic template support):</p><div class="confluenceTableSmall"><div class="table-wrap"><table class="confluenceTable"><tr><th class="confluenceTh"> Header </th><th class="confluenceTh"> Description </th></tr><tr><td class="confluenceTd"> <tt>CamelScalateResource</tt> </td><td class="confluenceTd"> The resource as an <tt>org.springframework.core.io.Resource</tt> object. </td></tr><tr><td class="confluenceTd"> <tt>CamelScalateResourceUri</tt> </td><td class="confluenceTd"> The <strong>templateName</strong> as a <tt>String</tt> object. </td></tr></table></div></div><p>Headers set during the Scalate evaluation are returned to the message and added as headers. Then its kinda possible to return values from Scalate to the Message.</p><p>For example, to set the header value of <tt>fruit</tt> in the Scalate template <tt>.tm</tt>:</p><div class="syntax"><div class="highlight"><pre><span class="k">&lt;%</span> <span class="n">in</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="err">&#39;</span><span class="n">fruit</span><span class="err">&#39;</span><span class="o">,</span> <span class="err">&#39;</span><span class="n">Apple</span><span class="err">&#39;</span><span class="o">)</span> <span class="k">%&gt;</span>&#x000A;</pre></div>&#x000A;</div><p>The <tt>fruit</tt> header is now accessible from the <tt>message.out.headers</tt>.</p><h3 id="ScalateContext">Scalate Context</h3><p>Camel will provide exchange information in the Scalate context (just a <tt>Map</tt>). The <tt>Exchange</tt> is transfered as:</p><div class="confluenceTableSmall"><div class="table-wrap"><table class="confluenceTable"><tr><th class="confluenceTh"> key </th><th class="confluenceTh"> value </th></tr><tr><td class="confluenceTd"> <tt>exchange</tt> </td><td class="confluenceTd"> The <tt>Exchange</tt> itself. </td></tr><tr><td class="confluenceTd"> <tt>headers</tt> </td><td class="confluenceTd"> The headers of the In message. </td></tr><tr><td class="confluenceTd"> <tt>camelContext</tt> </td><td class="confluenceTd"> The Camel Context intance. </td></tr><tr><td class="confluenceTd"> <tt>request</tt> </td><td class="confluenceTd"> The In message. </td></tr><tr><td class="confluenceTd"> <tt>in</tt> </td><td class="confluenceTd"> The In message. </td></tr><tr><td class="confluenceTd"> <tt>body</tt> </td><td class="confluenceTd"> The In message body. </td></tr><tr><td class="confluenceTd"> <tt>out</tt> </td><td class="confluenceTd"> The Out message (only for InOut message exchange pattern). </td></tr><tr><td class="confluenceTd"> <tt>response</tt> </td><td class="confluenceTd"> The Out message (only for InOut message exchange pattern). </td></tr></table></div></div><h3 id="Hotreloading">Hot reloading</h3><p>The Scalate template resource is, by default, hot reloadable for both file and classpath resources (expanded jar). </p><h3 id="Dynamictemplates">Dynamic templates</h3><p>Camel provides two headers by which you can define a different resource location for a template or the template content itself. If any of these headers is set then Camel uses this over the endpoint configured resource. This allows you to provide a dynamic template at runtime.</p><div class="confluenceTableSmall"><div class="table-wrap"><table class="confluenceTable"><tr><th class="confluenceTh"> Header </th><th class="confluenceTh"> Type </th><th class="confluenceTh"> Description </th></tr><tr><td class="confluenceTd"> CamelScalateResourceUri </td><td class="confluenceTd"> String </td><td class="confluenceTd"> An URI for the template resource to use instead of the endpoint configured. </td></tr><tr><td class="confluenceTd"> CamelScalateTemplate </td><td class="confluenceTd"> String </td><td class="confluenceTd"> The template to use instead of the endpoint configured. </td></tr></table></div></div><h3 id="Samples">Samples</h3><p>For example you could use something like</p><div class="syntax"><div class="highlight"><pre><span class="n">from</span><span class="o">(</span><span class="s">&quot;activemq:My.Queue&quot;</span><span class="o">).</span>&#x000A;  <span class="n">to</span><span class="o">(</span><span class="s">&quot;scalate:com/acme/MyResponse.ssp&quot;</span><span class="o">);</span>&#x000A;</pre></div>&#x000A;</div><p>To use a Scalate template to formulate a response to a message for InOut message exchanges (where there is a <tt>JMSReplyTo</tt> header).</p><p>If you want to use InOnly and consume the message and send it to another destination, you could use the following route:</p><div class="syntax"><div class="highlight"><pre><span class="n">from</span><span class="o">(</span><span class="s">&quot;activemq:My.Queue&quot;</span><span class="o">).</span>&#x000A;  <span class="n">to</span><span class="o">(</span><span class="s">&quot;scalate:com/acme/MyResponse.scaml&quot;</span><span class="o">).</span>&#x000A;  <span class="n">to</span><span class="o">(</span><span class="s">&quot;activemq:Another.Queue&quot;</span><span class="o">);</span>&#x000A;</pre></div>&#x000A;</div><p>It's possible to specify what template the component should use dynamically via a header, so for example:</p><div class="syntax"><div class="highlight"><pre><span class="n">from</span><span class="o">(</span><span class="s">&quot;direct:in&quot;</span><span class="o">).</span>&#x000A;  <span class="n">setHeader</span><span class="o">(</span><span class="s">&quot;CamelScalateResourceUri&quot;</span><span class="o">).</span>&#x000A;    <span class="n">constant</span><span class="o">(</span><span class="s">&quot;path/to/my/template.scaml&quot;</span><span class="o">).</span>&#x000A;  <span class="n">to</span><span class="o">(</span><span class="s">&quot;scalate:dummy&quot;</span><span class="o">);</span>&#x000A;</pre></div>&#x000A;</div><p>It's possible to specify a template directly as a header the component should use dynamically via a header, so for example:</p><div class="syntax"><div class="highlight"><pre><span class="n">from</span><span class="o">(</span><span class="s">&quot;direct:in&quot;</span><span class="o">).</span>&#x000A;  <span class="n">setHeader</span><span class="o">(</span><span class="s">&quot;CamelScalateTemplate&quot;</span><span class="o">).</span>&#x000A;    <span class="n">constant</span><span class="o">(</span><span class="s">&quot;&lt;%@ attribute body: Object %&gt;\n&quot;</span> <span class="o">+</span> &#x000A;      <span class="s">&quot;Hi this is a scalate template that can do templating ${body}&quot;</span><span class="o">).</span>&#x000A;  <span class="n">to</span><span class="o">(</span><span class="s">&quot;scalate:dummy&quot;</span><span class="o">);</span>&#x000A;</pre></div>&#x000A;</div><h3 id="TheEmailSample">The Email Sample</h3><p>In this sample we want to use Scalate templating for an order confirmation email. The email template is laid out in Scalate as:</p><div class="syntax"><div class="highlight"><pre><span class="k">&lt;%@</span> <span class="n">attribute</span> <span class="nl">in:</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">camel</span><span class="o">.</span><span class="na">scala</span><span class="o">.</span><span class="na">RichMessage</span> <span class="k">%&gt;</span>&#x000A;&#x000A;Dear ${in(&quot;firstName&quot;)}&#x000A;&#x000A;Thanks for the order of ${in(&quot;item&quot;)}.&#x000A;&#x000A;Regards Camel Riders Bookstore&#x000A;${in.body}&#x000A;</pre></div>&#x000A;</div>
        <div></div>
      </div>
    </div>
    <script type='text/javascript'>
      //<![CDATA[
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
        </script> 
        <script type="text/javascript"> 
        try {
        var pageTracker = _gat._getTracker("UA-1347593-12");
        pageTracker._trackPageview();
        } catch(err) {}
      //]]>
    </script>
  </body>
</html>
